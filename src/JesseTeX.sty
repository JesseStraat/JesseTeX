\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{JesseTeX}[2021/12/29 Jesse's custom Package 3.0]



%How to make a JesseTeX document:
%
%\documentclass{article}
%\usepackage[lang = language]{JesseTeX}
%
%\title{title}
%\author{name\\000000} OR \author{name1\\000000 \authand name2\\000000}
%\tutorial{tutorial group}

%\begin{document}
%\maketitle
%foobar
%\end{document}


%If the document has multiple authors, use
%\author{Person 1 \\ 00000001 \authand Person 2 \\ 00000002}



%% Preamble to the package %%


% The following packages are used for some technical things %
\RequirePackage{kvoptions}
\RequirePackage{ifthen}
\RequirePackage{xstring}
\RequirePackage{xparse}
\RequirePackage{xspace}

% Setting up the options %
\SetupKeyvalOptions{}
	
	\DeclareStringOption[none]{theme}	% theme = true or theme = false
	
	\DeclareStringOption[dutch]{lang}	% Language options
	
	\DeclareStringOption[]{numbering}	% Numbering of theorem-like environments
	
	\newboolean{count}
	\setboolean{count}{true}
	\DeclareVoidOption{nocount}{ \setboolean{count}{false} }	% "Don't display total number of pages in title"
	
\ProcessKeyvalOptions*

% Checks whether we should apply the theme to the document %
\newboolean{theme}
% If the document class is article, we apply the theme by default %
\@ifclassloaded{article}{\setboolean{theme}{true}}{\setboolean{theme}{false}}
% Overwrites the option if an option was selected during loading %
\IfStrEqCase{\JesseTeX@theme}{%
	{true}{%
		\setboolean{theme}{true}
	}
	{false}{%
		\setboolean{theme}{false}
	}
	{none}{}
}



%% Setup %%

% Base packages %
\RequirePackage{color}								% Helps with colour definitions
\RequirePackage[\JesseTeX@lang]{babel}				% Language-related things
\RequirePackage{graphicx}							% Adding images
\usepackage{caption}								% Used primarily for subfigures
\usepackage{subcaption}								% Ditto
\RequirePackage{amsmath}							% Some mathematical symbols
\RequirePackage{amsfonts}							% Ditto
\RequirePackage{amssymb}							% Ditto
\RequirePackage{mathrsfs}							% Prettier mathscr symbols and the like
\RequirePackage{tensor}								% A package used for better index notations
\RequirePackage{slashed}							% For Dirac operators
\RequirePackage{mathtools}							% More mathematical symbols, e.g., for proofs
\RequirePackage{wasysym}							% Ditto
\RequirePackage{amsthm}								% Theorem environments (for proofs)
\RequirePackage{thmtools}							% Some tools for defining theorems
\RequirePackage{textcomp}							% Text symbols
\RequirePackage{comment}							% Allows a comment environment for multi-line comments
\RequirePackage{tabularx}							% Allows prettier tabular environments
% pgfplots has been removed to avoid compatibility issues
% \RequirePackage{pgfplots}							% Drawing plots (via TikZ)
\usetikzlibrary{calc}								% Aritmatic in TikZ drawings


%% Import JesseTeX libraries %%
% Non-essential macros are moved to libraries to save on compilation time
\newcommand{\importjesselibrary}[1]{%
	\usepackage{JesseTeX/src/libraries/JesseTeX-#1}
}


%% Theme %%
\ifthenelse{\boolean{theme}}{% then
	\importjesselibrary{theme}
}{% else
	% Redefines authand so the document doesn't break if you switch from theme to notheme %
	\def\authand{\and}
}


%% Language settings %%

% Default language (Dutch) %
%BEGIN_FOLD
\newcommand{\tutorialstr}{Werkcollegegroep }
\newcommand{\totpage}{Totaal aantal pagina's: }
\newcommand{\propo}{Voorstel}
\newcommand{\lemm}{Lemma}
\newcommand{\defin}{Definitie}
\newcommand{\theor}{Stelling}
\newcommand{\clai}{Bewering}
\newcommand{\coro}{Gevolg}
%END_FOLD

% Other languages %
\IfStrEqCase{\JesseTeX@lang}{%
	{english}{%BEGIN_FOLD
		\renewcommand{\tutorialstr}{Problem class }
		\renewcommand{\totpage}{Total number of pages: }
		\renewcommand{\propo}{Proposition}
		\renewcommand{\lemm}{Lemma}
		\renewcommand{\defin}{Definition}
		\renewcommand{\theor}{Theorem}
		\renewcommand{\clai}{Claim}
		\renewcommand{\coro}{Corollary}
	}%END_FOLD
}


%% Environments for proofs %%
\@ifclassloaded{beamer}{}{		%Beamer already loads these environments
	\newtheorem{proposition}{\propo}[\JesseTeX@numbering]
	\newtheorem*{proposition*}{\propo}
	
	\newtheorem{lemma}[proposition]{\lemm}
	\newtheorem*{lemma*}{\lemm}
	
	\newtheorem{definition}[proposition]{\defin}
	\newtheorem*{definition*}{\defin}
	
	\newtheorem{theorem}[proposition]{\theor}
	\newtheorem*{theorem*}{\theor}
	
	\newtheorem{claim}[proposition]{\clai}
	\newtheorem*{claim*}{\clai}
	
	\newtheorem{corollary}[proposition]{\coro}
	\newtheorem*{corollary*}{\coro}
}

% Deprecated environments %
\newtheorem{prop}{\propo}	%Proposition
\newtheorem*{prop*}{\propo}
\newtheorem{lem}{\lemm}		%Lemma
\newtheorem*{lem*}{\lemm}
\newtheorem{defi}{\defin}	%Definition
\newtheorem*{defi*}{\defin}
\newtheorem{stel}{\theor}	%Theorem
\newtheorem*{stel*}{\theor}
\newtheorem{cor}{\coro}		%Corollary
\newtheorem*{cor*}{\coro}


%% QOL improvements %%

% Swapping \epsilon and \varepsilon %
\let\temp\epsilon
\let\epsilon\varepsilon
\let\varepsilon\temp

% Swapping \phi and \varphi%
\let\temp\phi
\let\phi\varphi
\let\varphi\temp

% Adding \vu as alternative to \nu (for people who actually speak Greek)
\let\vu\nu

% Some sets %
\newcommand{\R}{\mathbb{R}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\K}{\mathbb{K}}
\newcommand{\bP}{\mathbb{P}}
\newcommand{\Id}{\operatorname{Id}}



%% Macros %%

\NewDocumentCommand{\cleartooddpage}{}{
	\clearpage
	\ifodd\value{page}\else\null\clearpage\fi
}
\NewDocumentCommand{\numberthis}{}{
	\addtocounter{equation}{1}\tag{\theequation}
}

\let\@quad\quad										% Temporary quad function
% #1(number) = number of quads
\RenewDocumentCommand{\quad}{ !O{1} }{%
	\IfInteger{#1}{%
		\foreach \x in {1,...,#1}{%
			\@quad%
		}%
		\/											% For some reason, this command eats the first next symbol
	}{%												% Therefore, a \/ has been inserted.
		\PackageError{JesseTeX}{#1 is not an integer}{Try using an integer}
	}%
}

% Some probability stuff %
%BEGIN_FOLD
\NewDocumentCommand{\prob}{ m } {					% Probability of a variable
	\mathbb{P}\left( #1 \right)
}
\NewDocumentCommand{\per}{ m }{ \prob{#1} }			% Deprecated
\NewDocumentCommand{\ex}{ m O{} } {					% Expectation value of a variable
	\mathbb{E}^{ #2 }\left[ #1 \right]
}
\NewDocumentCommand{\vari}{ m } {					% Variance of a variable
	\operatorname{Var}\left( #1 \right)
}
\NewDocumentCommand{\mse}{ m } {					% Mean squared error of a variable
	\operatorname{MSE}\left( #1 \right)
}
% Deprecated macros for a course in probability and statistics %
\newcommand{\convp}{\overset{p}{\to}}
\newcommand{\scrf}{\mathcal{F}}
\newcommand{\scrp}{\mathcal{P}}
%END_FOLD

% Some analysis stuff %
%BEGIN_FOLD
% Upper integral %
\def\upint{\mathchoice%
	{\mkern13mu\overline{\vphantom{\intop}\mkern10mu}\mkern-20mu}%
	{\mkern7mu\overline{\vphantom{\intop}\mkern10mu}\mkern-14mu}%
	{\mkern7mu\overline{\vphantom{\intop}\mkern10mu}\mkern-14mu}%
	{\mkern7mu\overline{\vphantom{\intop}\mkern10mu}\mkern-14mu}%
	\int}
% Lower integral %
\def\lowint{\mkern3mu\underline{\vphantom{\intop}\mkern10mu}\mkern-10mu\int}
%END_FOLD

% Topology %
%BEGIN_FOLD
% Set interior %
\NewDocumentCommand{\intr}{ m } {
	\ \operatorname{Int}\left( #1 \right)
}
%END_FOLD


%% Easter eggs (very secret) %%

% Improved QED command (as opposed to \qed) %
\newcommand{\QED}{
	\begin{tikzpicture}
		\draw [fill=red] (0, 0) -- (0, 4) arc[start angle=180, end angle=0, x radius = 1.5, y radius = 1] -- (3, 0) arc[start angle = 0, end angle = -180, x radius = 0.6, y radius = 0.25] -- (1.8, 0.8) -- (1.2, 0.8) -- (1.2, 0) arc[start angle = 0, end angle = -180, x radius = 0.6, y radius = 0.25];
		\draw [fill=white] (2.2,3.2) circle [x radius = 1.2, y radius = 0.6];
		\draw [fill=red] (0, 3.7) arc[start angle = 90, end angle = 270, y radius = 1.2, x radius = 0.6];
	\end{tikzpicture}
}

% Including tikzducks for scientific applications %
% https://tex.stackexchange.com/questions/422989/scientific-applications-of-the-tikzducks/423094 %
\RequirePackage{tikzducks}
% A scientific application %
\newcommand{\sussyduck}[1]{
	\duck[body = #1, bill = #1]
	\def\susscale{0.35}
	\def\xoffset{2.2}
	\def\yoffset{-.35}
	\shade[top color=blue!20, bottom color=blue!20!black]
	(-2.84*\susscale+\xoffset,6.11*\susscale+\yoffset) .. controls (-3.07*\susscale+\xoffset,6.37*\susscale+\yoffset) and (-4.06*\susscale+\xoffset,6.58*\susscale+\yoffset) ..
	(-4.61*\susscale+\xoffset,6.37*\susscale+\yoffset) .. controls (-5.15*\susscale+\xoffset,6.16*\susscale+\yoffset) and (-5.44*\susscale+\xoffset,5.85*\susscale+\yoffset) ..
	(-5.21*\susscale+\xoffset,5.38*\susscale+\yoffset) .. controls (-4.97*\susscale+\xoffset,4.91*\susscale+\yoffset) and (-3.67*\susscale+\xoffset,4.50*\susscale+\yoffset) ..
	(-3.15*\susscale+\xoffset,4.94*\susscale+\yoffset) .. controls (-2.63*\susscale+\xoffset,5.38*\susscale+\yoffset) and (-2.61*\susscale+\xoffset,5.85*\susscale+\yoffset) ..
	(-2.84*\susscale+\xoffset,6.11*\susscale+\yoffset) -- cycle;
	
}

% Improved command for bijection arrows %
\NewDocumentCommand{\bijection}{}{%
  \hookrightarrow\mathrel{\mspace{-15mu}}\rightarrow
}